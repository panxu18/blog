##### ARP协议

1. 每个主机都有一个ARP缓冲区，缓存IP地址和MAC地址的对应关系。
2. 先检查ARP缓存，如果没有缓存，向本网段内所有租借发生ARP数据包，包含：源主机IP、源主机MAC、目的主机IP。
3. 目的IP的主机收到收到ARP数据后检测将源主机IP和源主机MAC写入ARP缓存，然后向源主机发出响应，将自己的MAC地址写入ARP响应包。
4. ARP只能用于同网段，不同网段的IP，会先查找默认网关，如果没有默认网关直接失败。

##### ARP攻击

1. 伪造网关：攻击者向网段内的主机发送伪造的ARP响应，将网关重定向到错误的MAC地址。
2. 欺骗网关：攻击者向网关发送伪造的ARP响应，将网段内主机重定向到错误的MAC地址。
3. 欺骗主机：攻击者向同网段内的主机发送伪造的ARP响应，导致主机之间无法正常通信。
4. 泛洪攻击：攻击者伪造ARP报文，在网段内大量广播，导致主机无法正常学习ARP的映射。
5. 防御：
   1. 绑定默认网关的IP和MAC地址，防御网关欺骗。
   2. 动态ARP检测：网络设备对用户电脑的IP、MAC、使用的端口或信道进行记录，当用户电脑发送ARP响应包时检测用户是否有欺骗行为，如果发现伪造ARP包则对用户进行惩罚或者过滤伪造的包。